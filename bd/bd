1-
a)
select titulo 
from curso
where nome_dept = 'Comp. Sci.'
and creditos = 3

b)
select distinct a.ID 
from aluno a, instrutor i, mentor m
where a.ID = m.id_est
and i.ID = m.id_inst
and i.nome = 'Einstein'

c)
select max(salario)
from instrutor

d)
select nome 
from instrutor 
where salario = (select max(salario) from instrutor)

e)
select ID, id_curso, id_sec, semestre, ano
from realiza
where id_curso in
(select id_curso 
from secao 
where ano = 2017
and semestre = 'Outono')
and ano = 2017
and semestre = 'Outono'

f)
select count(distinct ID) from realiza 
where semestre = 'Outono'
and ano = 2017

g)
select course_id, sec_id, semester, year
from section
where (course_id, sec_id, semester, year) in 

(select course_id, sec_id, semester, year
from takes
where semester = 'Fall'
and
year = 2017
group by course_id, sec_id, semester, year
having count(ID) 

= 

(select max(total)
from(
select count(ID) as total
from takes
where semester = 'Fall'
and year = 2017
group by course_id, sec_id, semester, year) as max_counts));

2- 
a)
update instrutor 
set salario = salario + salario * 0.1 
where nome_dept = 'Comp. Sci.'

b)
delete from curse 
where id_curso not in (select id_curso from secao)

c)
insert into instrutor (ID, nome, nome_dept, salario) 
select ID, nome, nome_dept, 10000
from aluno
where tot_cred > 100

3-
a)
select distinct ID, nome from aluno
where ID in 
(select ID 
from realiza r, curso c
where r.id_curso = c.id_curso
and c.nome_dept = 'Comp. Sci.')

b)
select ID, nome from aluno
where ID not in 
(select ID from realiza 
where ano < 2017)

c)
select nome_dept, max(salario)
from instrutor
group by nome_dept

d)
select nome_dept, min(salario)
from instrutor
where salario in
(select max(salario) 
from instrutor
group by nome_dept)

4-
a)
insert into curso values('CS-001','Weekly Seminar','Comp. Sci.', 0)

b)
insert into secao values('CS-001', 1, 'Outono', 2017, NULL, NULL, NULL)

c)
insert into realiza (ID, id_curso, id_sec, semestre, ano, nota)
select ID, 'CS-001', 1, 'Outono', 2017, NULL from aluno
where nome_dept = 'Comp. Sci.'

d)
delete from realiza where ID = 12345 and id_curso = 'CS-001'

e)
delete from curso where id_curso = 'CS-001'
Os registros sao deletados da tabela realiza

f)
delete from realiza
where id_curso in
(select id_curos from curso
where titulo like '%database%')

5-
-- Consulta com OUTER JOIN
select e.ID
from empregado e
left join gerencia g ON e.ID = g.ID
where g.id_gerente is null or g.id_gerente = '';

-- Consulta sem OUTER JOIN
select e.ID
from empregado e
where e.ID not in (select ID from gerencia where id_gerente is not null and id_gerente <> '');

6-
